<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>COSMIC CLICKER</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --bg0: #02020f;
  --bg1: #07071a;
  --bg2: #0d0d28;
  --glass: rgba(255,255,255,0.04);
  --glass2: rgba(255,255,255,0.07);
  --border: rgba(255,255,255,0.08);
  --border2: rgba(255,255,255,0.14);
  --c1: #00ffcc;   /* mint */
  --c2: #ff2d78;   /* hot pink */
  --c3: #7b2fff;   /* violet */
  --c4: #ffb800;   /* amber */
  --c5: #00b4ff;   /* sky */
  --text: #d0ddf5;
  --dim: #3a4a6a;
  --white: #ffffff;
}

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}

html,body{
  height:100%; background:var(--bg0);
  color:var(--text); font-family:'Exo 2',sans-serif;
  overflow:hidden; -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}

/* â”€â”€ BACKGROUND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#bg{position:fixed;inset:0;z-index:0;overflow:hidden;}
#bg::before{
  content:'';position:absolute;inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 15% 20%, rgba(123,47,255,.18) 0%, transparent 60%),
    radial-gradient(ellipse 60% 50% at 85% 70%, rgba(0,255,204,.1) 0%, transparent 55%),
    radial-gradient(ellipse 50% 40% at 50% 100%, rgba(255,45,120,.08) 0%, transparent 50%);
}
#canvas{position:absolute;inset:0;width:100%;height:100%;}

/* â”€â”€ SHELL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.shell{
  position:relative;z-index:1;
  display:flex;flex-direction:column;
  height:100%;max-width:480px;margin:0 auto;
}

/* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hdr{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px 8px;
  background:rgba(2,2,15,.7);
  backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  flex-shrink:0;
}
.hdr-left{display:flex;align-items:center;gap:10px;}
.avatar{
  width:34px;height:34px;border-radius:50%;
  background:linear-gradient(135deg,var(--c3),var(--c2));
  display:flex;align-items:center;justify-content:center;
  font-size:15px;font-weight:700;color:#fff;
  flex-shrink:0;overflow:hidden;
  box-shadow:0 0 12px rgba(123,47,255,.5);
}
.avatar img{width:100%;height:100%;object-fit:cover;}
.uname{font-size:13px;font-weight:700;color:var(--white);max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.utitle{font-size:9px;color:var(--c1);letter-spacing:2px;margin-top:1px;}

.hdr-stats{display:flex;gap:14px;}
.hs{text-align:center;}
.hs-l{font-size:8px;letter-spacing:1.5px;color:var(--dim);text-transform:uppercase;}
.hs-v{font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--c1);}
.hs-v.amber{color:var(--c4);}

/* â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.tabs{
  display:flex;background:rgba(2,2,15,.6);
  border-bottom:1px solid var(--border);flex-shrink:0;
}
.tab{
  flex:1;padding:9px 4px;text-align:center;
  font-size:11px;letter-spacing:1px;font-weight:600;
  color:var(--dim);cursor:pointer;
  border-bottom:2px solid transparent;
  transition:all .2s;text-transform:uppercase;
}
.tab.active{color:var(--c1);border-color:var(--c1);}

/* â”€â”€ CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.content{flex:1;overflow-y:auto;overflow-x:hidden;position:relative;}
.page{display:none;flex-direction:column;}
.page.active{display:flex;}

::-webkit-scrollbar{width:2px;}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:1px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CLICKER PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pg-click{
  align-items:center;padding:14px 16px 20px;gap:14px;
  min-height:100%;
}

/* SCORE */
.score-wrap{text-align:center;position:relative;}
.score-num{
  font-family:'Share Tech Mono',monospace;
  font-size:clamp(32px,8vw,48px);font-weight:700;
  color:var(--white);line-height:1;
  text-shadow:0 0 30px rgba(0,255,204,.6),0 0 60px rgba(0,255,204,.3);
  letter-spacing:2px;
}
.score-unit{font-size:10px;letter-spacing:4px;color:var(--dim);text-transform:uppercase;margin-top:4px;}
.score-cps{font-size:12px;color:var(--c3);margin-top:3px;font-family:'Share Tech Mono',monospace;}

/* COMBO */
.combo-wrap{
  display:flex;align-items:center;gap:6px;
  background:var(--glass);border:1px solid var(--border);
  border-radius:20px;padding:5px 14px;
  transition:all .2s;
}
.combo-wrap.active{
  background:rgba(255,184,0,.08);
  border-color:rgba(255,184,0,.3);
  box-shadow:0 0 15px rgba(255,184,0,.15);
}
.combo-label{font-size:9px;letter-spacing:2px;color:var(--dim);text-transform:uppercase;}
.combo-val{font-family:'Share Tech Mono',monospace;font-size:14px;font-weight:700;color:var(--c4);}
.combo-bar-wrap{flex:1;height:4px;background:rgba(255,255,255,.05);border-radius:2px;overflow:hidden;}
.combo-bar{height:100%;background:linear-gradient(90deg,var(--c4),var(--c2));border-radius:2px;transition:width .1s linear;}

/* BUTTON */
.btn-arena{
  position:relative;width:200px;height:200px;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;
}
.orbit{position:absolute;border-radius:50%;animation:orb linear infinite;}
.o1{inset:0;border:1px solid rgba(0,255,204,.2);animation-duration:10s;}
.o2{inset:14px;border:1px dashed rgba(123,47,255,.25);animation-duration:16s;animation-direction:reverse;}
.o3{inset:28px;border:1px solid rgba(255,45,120,.15);animation-duration:8s;}
.o4{inset:42px;border:1px dotted rgba(0,180,255,.2);animation-duration:20s;animation-direction:reverse;}
@keyframes orb{to{transform:rotate(360deg);}}

/* Glow pulse */
.glow-ring{
  position:absolute;inset:30px;border-radius:50%;
  box-shadow:0 0 0 0 rgba(0,255,204,.4);
  animation:glowPulse 2s ease-in-out infinite;
}
@keyframes glowPulse{
  0%,100%{box-shadow:0 0 0 0 rgba(0,255,204,.3);}
  50%{box-shadow:0 0 0 20px rgba(0,255,204,.0);}
}

.click-btn{
  position:relative;z-index:5;
  width:130px;height:130px;border-radius:50%;
  border:none;cursor:pointer;
  background:
    radial-gradient(circle at 35% 30%,rgba(255,255,255,.15),transparent 55%),
    radial-gradient(circle,#0e0e2a 0%,#050510 100%);
  box-shadow:
    0 0 0 2px rgba(0,255,204,.3),
    0 0 40px rgba(0,255,204,.15),
    0 0 80px rgba(123,47,255,.1),
    inset 0 0 30px rgba(0,255,204,.05);
  font-size:44px;
  transition:transform .07s,box-shadow .07s;
  display:flex;align-items:center;justify-content:center;
  -webkit-tap-highlight-color:transparent;
  overflow:hidden;
}
.click-btn::after{
  content:'';position:absolute;inset:0;border-radius:50%;
  background:radial-gradient(circle,rgba(0,255,204,.15) 0%,transparent 70%);
  opacity:0;transition:opacity .1s;
}
.click-btn:active{
  transform:scale(.88);
  box-shadow:
    0 0 0 3px var(--c1),
    0 0 60px rgba(0,255,204,.6),
    0 0 120px rgba(123,47,255,.3),
    inset 0 0 60px rgba(0,255,204,.2);
}
.click-btn:active::after{opacity:1;}

/* BOOSTS row */
.boosts-row{display:flex;gap:8px;width:100%;}
.boost-chip{
  flex:1;background:var(--glass);border:1px solid var(--border);
  border-radius:10px;padding:8px;text-align:center;cursor:pointer;
  transition:all .15s;position:relative;overflow:hidden;
}
.boost-chip:active{transform:scale(.96);}
.boost-chip.active-boost{
  border-color:rgba(0,255,204,.4);
  background:rgba(0,255,204,.07);
  box-shadow:0 0 15px rgba(0,255,204,.15);
}
.boost-chip-icon{font-size:18px;}
.boost-chip-name{font-size:9px;color:var(--dim);letter-spacing:1px;margin-top:2px;}
.boost-chip-val{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--c1);margin-top:1px;}
.boost-chip-cd{
  position:absolute;bottom:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,var(--c1),var(--c3));
  transform-origin:left;transition:transform .1s linear;
}

/* STATS GRID */
.stats-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;width:100%;}
.stat-card{
  background:var(--glass);border:1px solid var(--border);
  border-radius:10px;padding:10px 8px;text-align:center;
}
.stat-card-l{font-size:8px;letter-spacing:1.5px;color:var(--dim);text-transform:uppercase;}
.stat-card-v{font-family:'Share Tech Mono',monospace;font-size:13px;color:var(--white);margin-top:3px;}

/* PRESTIGE BAR */
.pbar-section{width:100%;}
.pbar-head{display:flex;justify-content:space-between;font-size:9px;letter-spacing:2px;color:var(--dim);text-transform:uppercase;margin-bottom:5px;}
.pbar-track{height:6px;background:rgba(255,255,255,.04);border-radius:3px;overflow:hidden;border:1px solid var(--border);}
.pbar-fill{
  height:100%;border-radius:3px;
  background:linear-gradient(90deg,var(--c3),var(--c1));
  transition:width .4s ease;
  box-shadow:0 0 8px rgba(0,255,204,.5);
  position:relative;overflow:hidden;
}
.pbar-fill::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.3) 50%,transparent 100%);
  animation:shimmer 2s linear infinite;
}
@keyframes shimmer{from{transform:translateX(-100%)}to{transform:translateX(100%)}}

.prestige-btn{
  width:100%;padding:13px;
  background:linear-gradient(135deg,rgba(255,184,0,.1),rgba(255,120,0,.12));
  border:1px solid rgba(255,184,0,.45);
  border-radius:12px;color:var(--c4);
  font-family:'Exo 2',sans-serif;font-weight:700;
  font-size:13px;letter-spacing:3px;
  cursor:pointer;transition:all .2s;text-transform:uppercase;
  box-shadow:0 0 20px rgba(255,184,0,.08);
}
.prestige-btn:active{
  background:linear-gradient(135deg,rgba(255,184,0,.2),rgba(255,120,0,.22));
  box-shadow:0 0 40px rgba(255,184,0,.25);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHOP PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pg-shop{padding:10px 12px 20px;gap:8px;overflow-y:auto;}

.sec-title{
  font-size:9px;letter-spacing:3px;color:var(--dim);
  text-transform:uppercase;padding:10px 0 7px;
  border-bottom:1px solid var(--border);flex-shrink:0;
  display:flex;align-items:center;gap:6px;
}
.sec-title::before{content:'';width:3px;height:10px;background:var(--c1);border-radius:2px;}

/* Stars grid */
.stars-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.star-card{
  background:var(--glass);
  border:1px solid rgba(255,184,0,.2);
  border-radius:12px;padding:12px;
  cursor:pointer;transition:all .18s;
  position:relative;overflow:hidden;
}
.star-card::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,184,0,.06),transparent);
  opacity:0;transition:opacity .2s;
}
.star-card:active{transform:scale(.96);}
.star-card:active::before{opacity:1;}
.sc-icon{font-size:26px;margin-bottom:5px;}
.sc-name{font-size:12px;font-weight:700;color:var(--white);}
.sc-desc{font-size:10px;color:var(--dim);margin:3px 0 7px;line-height:1.4;}
.sc-price{
  font-family:'Share Tech Mono',monospace;font-size:11px;
  color:var(--c4);display:flex;align-items:center;gap:3px;
}
.sc-badge{
  position:absolute;top:8px;right:8px;
  background:rgba(0,255,204,.15);border:1px solid rgba(0,255,204,.3);
  border-radius:4px;padding:1px 5px;font-size:8px;color:var(--c1);letter-spacing:1px;
}

/* Gen cards */
.gen-card{
  background:var(--glass);border:1px solid var(--border);
  border-radius:10px;padding:11px 12px;
  cursor:pointer;transition:all .15s;
  display:flex;align-items:center;gap:10px;
}
.gen-card:active:not(.gc-locked){
  background:rgba(255,45,120,.06);
  border-color:rgba(255,45,120,.3);
}
.gc-locked{opacity:.3;pointer-events:none;}
.gc-icon{font-size:26px;flex-shrink:0;}
.gc-body{flex:1;min-width:0;}
.gc-name{font-size:13px;font-weight:700;color:var(--white);}
.gc-sub{font-size:10px;color:var(--dim);margin-top:1px;}
.gc-cost{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--c4);margin-top:3px;}
.gc-owned{
  font-family:'Share Tech Mono',monospace;
  font-size:24px;font-weight:700;
  color:var(--c2);min-width:32px;text-align:right;
}
.gc-cps{font-size:9px;color:var(--c1);text-align:right;margin-top:1px;}

/* Upgrade cards */
.upg-card{
  background:var(--glass);border:1px solid var(--border);
  border-radius:10px;padding:10px 12px;
  cursor:pointer;transition:all .15s;
  display:flex;align-items:center;gap:10px;
}
.upg-card:active:not(.uc-locked):not(.uc-maxed){
  background:rgba(0,255,204,.05);
  border-color:rgba(0,255,204,.3);
}
.uc-locked{opacity:.3;pointer-events:none;}
.uc-maxed{border-color:rgba(255,184,0,.2);pointer-events:none;}
.uc-icon{font-size:22px;flex-shrink:0;}
.uc-body{flex:1;}
.uc-name{font-size:12px;font-weight:700;color:var(--white);}
.uc-desc{font-size:10px;color:var(--dim);margin-top:1px;}
.uc-right{text-align:right;flex-shrink:0;}
.uc-cost{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--c4);}
.uc-status{font-size:9px;color:var(--dim);margin-top:2px;letter-spacing:1px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FRIENDS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pg-friends{padding:14px;gap:10px;overflow-y:auto;}

.ref-hero{
  background:linear-gradient(135deg,rgba(0,255,204,.07),rgba(123,47,255,.07));
  border:1px solid rgba(0,255,204,.18);
  border-radius:14px;padding:18px;text-align:center;
}
.ref-icon{font-size:36px;margin-bottom:8px;}
.ref-title{font-family:'Share Tech Mono',monospace;font-size:16px;color:var(--c1);margin-bottom:6px;letter-spacing:2px;}
.ref-desc{font-size:12px;color:var(--dim);line-height:1.6;margin-bottom:10px;}
.ref-bonus{
  background:rgba(0,255,204,.07);border:1px solid rgba(0,255,204,.2);
  border-radius:8px;padding:8px;
  font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--c1);
  margin-bottom:12px;
}
.ref-btn{
  width:100%;padding:12px;
  background:linear-gradient(135deg,rgba(0,255,204,.12),rgba(123,47,255,.12));
  border:1px solid rgba(0,255,204,.35);
  border-radius:10px;color:var(--c1);
  font-family:'Exo 2',sans-serif;font-weight:700;
  font-size:12px;letter-spacing:2px;text-transform:uppercase;
  cursor:pointer;transition:all .2s;
}
.ref-btn:active{transform:scale(.97);}

.friends-head{
  font-family:'Share Tech Mono',monospace;
  font-size:11px;color:var(--dim);text-align:center;
}
.friends-head span{color:var(--c1);}

.friend-row{
  background:var(--glass);border:1px solid var(--border);
  border-radius:10px;padding:10px 14px;
  display:flex;align-items:center;gap:10px;
}
.fr-av{
  width:38px;height:38px;border-radius:50%;
  background:linear-gradient(135deg,var(--c3),var(--c2));
  display:flex;align-items:center;justify-content:center;
  font-size:17px;font-weight:700;color:#fff;flex-shrink:0;
}
.fr-info{flex:1;}
.fr-name{font-size:13px;font-weight:700;color:var(--white);}
.fr-score{font-size:10px;color:var(--dim);}
.fr-earn{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--c1);}

/* â”€â”€ PARTICLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.ptc{
  position:fixed;pointer-events:none;z-index:999;
  font-family:'Share Tech Mono',monospace;font-size:15px;font-weight:700;
  animation:ptcUp .85s ease-out forwards;
}
@keyframes ptcUp{
  0%{opacity:1;transform:translateY(0) scale(1);}
  100%{opacity:0;transform:translateY(-80px) scale(.4);}
}

/* Critical hit particle */
.ptc-crit{font-size:22px!important;animation-duration:1.1s!important;}

/* â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toast{
  position:fixed;top:68px;left:50%;transform:translateX(-50%);
  background:rgba(7,7,26,.95);
  border:1px solid rgba(0,255,204,.35);border-radius:10px;
  padding:9px 18px;
  font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--c1);
  letter-spacing:1.5px;z-index:1000;pointer-events:none;
  box-shadow:0 0 25px rgba(0,255,204,.12);
  animation:tIn .3s ease,tOut .3s ease 2.7s forwards;
  white-space:nowrap;max-width:92vw;text-align:center;
}
@keyframes tIn{from{opacity:0;top:52px;}to{opacity:1;top:68px;}}
@keyframes tOut{to{opacity:0;top:52px;}}

/* â”€â”€ LEVEL UP FLASH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.levelup{
  position:fixed;inset:0;z-index:998;pointer-events:none;
  background:radial-gradient(circle,rgba(0,255,204,.15) 0%,transparent 70%);
  animation:lvlFlash .6s ease-out forwards;
}
@keyframes lvlFlash{
  0%{opacity:1;}100%{opacity:0;}
}

/* â”€â”€ ACTIVE BOOST TIMER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.active-timer{
  font-family:'Share Tech Mono',monospace;
  font-size:9px;color:var(--c1);
  letter-spacing:1px;text-align:center;
  animation:blink 1s ease-in-out infinite;
}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:.4;}}
</style>
</head>
<body>
<div id="bg"><canvas id="canvas"></canvas></div>

<div class="shell">
  <!-- HEADER -->
  <div class="hdr">
    <div class="hdr-left">
      <div class="avatar" id="avatar">?</div>
      <div>
        <div class="uname" id="uname">ĞšĞ¾ÑĞ¼Ğ¾Ğ½Ğ°Ğ²Ñ‚</div>
        <div class="utitle" id="utitle">ĞĞĞ’ĞĞ‘Ğ ĞĞĞ•Ğ¦</div>
      </div>
    </div>
    <div class="hdr-stats">
      <div class="hs"><div class="hs-l">Ğ’ÑĞµĞ³Ğ¾</div><div class="hs-v" id="hTotal">0</div></div>
      <div class="hs"><div class="hs-l">Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ</div><div class="hs-v amber" id="hLevel">1</div></div>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <div class="tab active" data-tab="click">âš¡ ĞšĞ»Ğ¸Ğº</div>
    <div class="tab" data-tab="shop">ğŸª ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</div>
    <div class="tab" data-tab="friends">ğŸ‘¥ Ğ”Ñ€ÑƒĞ·ÑŒÑ</div>
  </div>

  <div class="content">

    <!-- â•â• CLICKER PAGE â•â• -->
    <div class="page active pg-click" id="page-click">

      <div class="score-wrap">
        <div class="score-num" id="scoreNum">0</div>
        <div class="score-unit">ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ</div>
        <div class="score-cps" id="scoreCps">+0/Ñ</div>
      </div>

      <!-- COMBO -->
      <div class="combo-wrap" id="comboWrap">
        <div class="combo-label">COMBO</div>
        <div class="combo-val" id="comboVal">Ã—1.0</div>
        <div class="combo-bar-wrap"><div class="combo-bar" id="comboBar" style="width:100%"></div></div>
      </div>

      <!-- BUTTON -->
      <div class="btn-arena">
        <div class="orbit o1"></div>
        <div class="orbit o2"></div>
        <div class="orbit o3"></div>
        <div class="orbit o4"></div>
        <div class="glow-ring"></div>
        <button class="click-btn" id="mainBtn">âš¡</button>
      </div>

      <!-- ACTIVE BOOSTS -->
      <div class="boosts-row">
        <div class="boost-chip" id="bFrenzy">
          <div class="boost-chip-icon">ğŸ”¥</div>
          <div class="boost-chip-name">FRENZY</div>
          <div class="boost-chip-val" id="bFrenzyVal">Ã—3</div>
          <div class="boost-chip-cd" id="bFrenzyCd" style="transform:scaleX(0)"></div>
        </div>
        <div class="boost-chip" id="bLucky">
          <div class="boost-chip-icon">ğŸ€</div>
          <div class="boost-chip-name">LUCKY</div>
          <div class="boost-chip-val" id="bLuckyVal">ĞšĞ Ğ˜Ğ¢</div>
          <div class="boost-chip-cd" id="bLuckyCd" style="transform:scaleX(0)"></div>
        </div>
        <div class="boost-chip" id="bRush">
          <div class="boost-chip-icon">âš¡</div>
          <div class="boost-chip-name">RUSH</div>
          <div class="boost-chip-val" id="bRushVal">+CPS</div>
          <div class="boost-chip-cd" id="bRushCd" style="transform:scaleX(0)"></div>
        </div>
      </div>

      <!-- STATS -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card-l">ĞšĞ»Ğ¸Ğº</div>
          <div class="stat-card-v" id="scClick">1</div>
        </div>
        <div class="stat-card">
          <div class="stat-card-l">Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹</div>
          <div class="stat-card-v" id="scGens">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-card-l">ĞŸÑ€ĞµÑÑ‚Ğ¸Ğ¶</div>
          <div class="stat-card-v" id="scPrestige">Ã—1</div>
        </div>
      </div>

      <!-- PRESTIGE -->
      <div class="pbar-section">
        <div class="pbar-head">
          <span>Ğ”Ğ¾ Ğ¿Ñ€ĞµÑÑ‚Ğ¸Ğ¶Ğ°</span><span id="pbarPct">0%</span>
        </div>
        <div class="pbar-track">
          <div class="pbar-fill" id="pbarFill" style="width:0%"></div>
        </div>
      </div>

      <button class="prestige-btn" id="prestigeBtn" style="display:none">
        âœ¨ ĞŸĞ Ğ•Ğ¡Ğ¢Ğ˜Ğ– â€” ĞĞĞ’Ğ«Ğ™ Ğ¦Ğ˜ĞšĞ› âœ¨
      </button>

    </div>

    <!-- â•â• SHOP PAGE â•â• -->
    <div class="page pg-shop" id="page-shop">

      <div class="sec-title">â­ Premium (Telegram Stars)</div>
      <div class="stars-grid" id="starsGrid"></div>

      <div class="sec-title">ğŸ­ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹</div>
      <div id="genList"></div>

      <div class="sec-title">âš¡ Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ</div>
      <div id="upgList"></div>

    </div>

    <!-- â•â• FRIENDS PAGE â•â• -->
    <div class="page pg-friends" id="page-friends">
      <div class="ref-hero">
        <div class="ref-icon">ğŸš€</div>
        <div class="ref-title">ĞŸĞ Ğ˜Ğ“Ğ›ĞĞ¡Ğ˜ Ğ”Ğ Ğ£Ğ—Ğ•Ğ™</div>
        <div class="ref-desc">ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ñ‹Ğ¹ Ğ´Ñ€ÑƒĞ³ Ğ´Ğ°Ñ‘Ñ‚ Ñ‚ĞµĞ±Ğµ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ Ğº Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ñƒ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸!</div>
        <div class="ref-bonus">ğŸ +10% Ğº Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ñƒ Ğ·Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ°</div>
        <button class="ref-btn" id="shareBtn">ğŸ“¤ ĞŸĞĞ”Ğ•Ğ›Ğ˜Ğ¢Ğ¬Ğ¡Ğ¯ Ğ¡Ğ¡Ğ«Ğ›ĞšĞĞ™</button>
      </div>
      <div class="friends-head">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¾: <span id="friendCount">0</span></div>
      <div id="friendList"></div>
    </div>

  </div>
</div>

<script>
'use strict';

/* â•â• TELEGRAM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const tg = window.Telegram?.WebApp;
let TGU = null;
if(tg){
  tg.ready(); tg.expand();
  try{tg.requestFullscreen?.();}catch(e){}
  tg.disableVerticalSwipes?.();
  TGU = tg.initDataUnsafe?.user||null;
}

/* â•â• CANVAS STARFIELD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(()=>{
  const cv=document.getElementById('canvas');
  const cx=cv.getContext('2d');
  let W,H,stars=[];
  const resize=()=>{W=cv.width=innerWidth;H=cv.height=innerHeight;};
  resize(); window.addEventListener('resize',resize);
  for(let i=0;i<220;i++) stars.push({
    x:Math.random(),y:Math.random(),
    r:Math.random()*1.4+.2,
    a:Math.random(),s:(Math.random()-.5)*.004,
    hue:Math.random()>.8?(Math.random()>.5?168:270):0
  });
  const draw=()=>{
    cx.clearRect(0,0,W,H);
    stars.forEach(s=>{
      s.a=Math.max(.08,Math.min(1,s.a+s.s));
      if(s.a<=.08||s.a>=1)s.s*=-1;
      cx.beginPath();cx.arc(s.x*W,s.y*H,s.r,0,Math.PI*2);
      cx.fillStyle=s.hue===0?`rgba(255,255,255,${s.a})`:`hsla(${s.hue},100%,75%,${s.a*.8})`;
      cx.fill();
    });
    requestAnimationFrame(draw);
  };
  draw();
})();

/* â•â• GAME DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const GENS=[
  {id:'solar',    icon:'â˜€ï¸', name:'Ğ¡Ğ¾Ğ»Ğ½ĞµÑ‡Ğ½Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ',   baseCost:15,        baseCps:.1,   desc:'Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ±Ğ¾Ñ€'},
  {id:'wind',     icon:'ğŸŒ€', name:'Ğ’ĞµÑ‚Ñ€Ğ¾Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€',      baseCost:100,       baseCps:.5,   desc:'Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº'},
  {id:'plasma',   icon:'ğŸ”µ', name:'ĞŸĞ»Ğ°Ğ·Ğ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ°ĞºÑ‚Ğ¾Ñ€',  baseCost:1100,      baseCps:4,    desc:'Ğ“Ğ¾Ñ€ÑÑ‡Ğ°Ñ Ğ¿Ğ»Ğ°Ğ·Ğ¼Ğ°'},
  {id:'quantum',  icon:'âš›ï¸',name:'ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ»Ğ»Ğ°Ğ¹Ğ´ĞµÑ€',baseCost:12000,     baseCps:20,   desc:'ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚ÑƒĞ½Ğ½ĞµĞ»ÑŒ'},
  {id:'pulsar',   icon:'ğŸ’«', name:'ĞŸÑƒĞ»ÑŒÑĞ°Ñ€',             baseCost:80000,     baseCps:80,   desc:'ĞŸÑƒĞ»ÑŒÑĞ¸Ñ€ÑƒÑÑ‰Ğ°Ñ Ğ·Ğ²ĞµĞ·Ğ´Ğ°'},
  {id:'star',     icon:'ğŸŒŸ', name:'Ğ—Ğ²Ñ‘Ğ·Ğ´Ğ½Ñ‹Ğ¹ Ñ…Ğ°Ñ€Ğ²ĞµÑÑ‚ĞµÑ€',  baseCost:500000,    baseCps:320,  desc:'Ğ¡Ğ±Ğ¾Ñ€ Ğ·Ğ²Ñ‘Ğ·Ğ´Ğ½Ğ¾Ğ¹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸'},
  {id:'blackhole',icon:'ğŸ•³ï¸',name:'Ğ§Ñ‘Ñ€Ğ½Ğ°Ñ Ğ´Ñ‹Ñ€Ğ°',         baseCost:4000000,   baseCps:1500, desc:'Ğ“Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹'},
  {id:'portal',   icon:'ğŸŒŒ', name:'Ğ˜Ğ·Ğ¼ĞµÑ€Ğ¸Ñ‚. Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ğ»',     baseCost:40000000,  baseCps:7000, desc:'ĞœĞµĞ¶Ğ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğ¾'},
  {id:'bigbang',  icon:'ğŸ’¥', name:'Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ Ğ²Ğ·Ñ€Ñ‹Ğ²',       baseCost:500000000, baseCps:30000,desc:'Ğ Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ¹'},
];

const UPGRADES=[
  {id:'u1', icon:'ğŸ§¤',name:'Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿ĞµÑ€Ñ‡Ğ°Ñ‚ĞºĞ¸',  desc:'ĞšĞ»Ğ¸Ğº Ã—2',          cost:100,    req:0,       type:'click', val:2},
  {id:'u2', icon:'âš¡',name:'Ğ­Ğ½ĞµÑ€Ğ³Ğ¾Ğ¿ĞµÑ€Ñ‡Ğ°Ñ‚ĞºĞ¸',      desc:'ĞšĞ»Ğ¸Ğº Ã—3',          cost:600,    req:150,     type:'click', val:3},
  {id:'u3', icon:'ğŸ’',name:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿ĞµÑ€Ñ‡Ğ°Ñ‚ĞºĞ¸',desc:'ĞšĞ»Ğ¸Ğº Ã—5',          cost:8000,   req:2000,    type:'click', val:5},
  {id:'u4', icon:'ğŸŒŒ',name:'ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ñ€ÑƒĞºĞ¸',       desc:'ĞšĞ»Ğ¸Ğº Ã—10',         cost:200000, req:50000,   type:'click', val:10},
  {id:'u5', icon:'â˜€ï¸',name:'Ğ¡Ğ¾Ğ»Ğ½ĞµÑ‡Ğ½Ñ‹Ğ¹ Ğ±ÑƒÑÑ‚',       desc:'Ğ¡Ğ¾Ğ»Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ã—2',    cost:250,    req:80,      type:'gen',   id2:'solar',     val:2},
  {id:'u6', icon:'ğŸŒ€',name:'ĞœĞ¾Ñ‰Ğ½Ñ‹Ğ¹ Ğ²ĞµÑ‚ĞµÑ€',         desc:'Ğ’ĞµÑ‚ĞµÑ€ Ã—2',        cost:1500,   req:400,     type:'gen',   id2:'wind',      val:2},
  {id:'u7', icon:'ğŸ”µ',name:'ĞŸĞ»Ğ°Ğ·Ğ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ±ÑƒÑÑ‚',      desc:'ĞŸĞ»Ğ°Ğ·Ğ¼Ğ° Ã—2',       cost:15000,  req:3000,    type:'gen',   id2:'plasma',    val:2},
  {id:'u8', icon:'âš›ï¸',name:'ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ',  desc:'ĞšĞ¾Ğ»Ğ»Ğ°Ğ¹Ğ´ĞµÑ€ Ã—2',    cost:150000, req:30000,   type:'gen',   id2:'quantum',   val:2},
  {id:'u9', icon:'ğŸ¤–',name:'ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº I',           desc:'+3 Ğ°Ğ²Ñ‚Ğ¾/Ñ',        cost:2500,   req:800,     type:'auto',  val:3},
  {id:'u10',icon:'ğŸ¤–',name:'ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº II',          desc:'+10 Ğ°Ğ²Ñ‚Ğ¾/Ñ',       cost:60000,  req:15000,   type:'auto',  val:10},
  {id:'u11',icon:'ğŸ¤–',name:'ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº III',         desc:'+50 Ğ°Ğ²Ñ‚Ğ¾/Ñ',       cost:2000000,req:500000,  type:'auto',  val:50},
  {id:'u12',icon:'ğŸŒ',name:'Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ',  desc:'Ğ’ÑÑ‘ Ã—1.5',         cost:100000, req:20000,   type:'global',val:1.5},
  {id:'u13',icon:'ğŸŒŒ',name:'Ğ¢Ñ‘Ğ¼Ğ½Ğ°Ñ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ñ',       desc:'Ğ’ÑÑ‘ Ã—2',           cost:2000000,req:300000,  type:'global',val:2},
  {id:'u14',icon:'ğŸ’«',name:'Ğ¡Ğ¸Ğ½Ğ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ÑÑ‚ÑŒ',        desc:'Ğ’ÑÑ‘ Ã—3',           cost:50000000,req:5000000,type:'global',val:3},
];

const STARS_ITEMS=[
  {id:'frenzy',    icon:'ğŸ”¥',name:'Frenzy Boost',   desc:'Ã—3 ĞºĞ»Ğ¸Ğº Ğ½Ğ° 30 Ğ¼Ğ¸Ğ½',   stars:25,  badge:'Ğ¥Ğ†Ğ¢Ğ†'},
  {id:'autoclick', icon:'ğŸ¤–',name:'ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº PRO',   desc:'+100 ĞºĞ»Ğ¸ĞºĞ¾Ğ²/Ñ Ğ½Ğ°Ğ²ÑĞµĞ³Ğ´Ğ°',stars:50, badge:''},
  {id:'x5',        icon:'ğŸš€',name:'ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ¿Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€', desc:'Ã—5 ĞºĞ¾ Ğ²ÑĞµĞ¼Ñƒ Ğ½Ğ°Ğ²ÑĞµĞ³Ğ´Ğ°', stars:100, badge:'Ğ¢ĞĞŸ'},
  {id:'prestige',  icon:'âœ¨',name:'ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞº ÑĞ±Ñ€Ğ¾ÑĞ°', desc:'ĞŸÑ€ĞµÑÑ‚Ğ¸Ğ¶ Ğ±ĞµĞ· Ğ¿Ğ¾Ñ‚ĞµÑ€ÑŒ',   stars:200, badge:''},
];

const PRESTIGE_GOAL=1000000;
const TITLES=['ĞĞĞ’ĞĞ‘Ğ ĞĞĞ•Ğ¦','ĞŸĞ˜Ğ›ĞĞ¢','ĞšĞĞŸĞ˜Ğ¢ĞĞ','ĞĞ”ĞœĞ˜Ğ ĞĞ›','Ğ“Ğ•ĞĞ•Ğ ĞĞ›','Ğ›Ğ•Ğ“Ğ•ĞĞ”Ğ','Ğ‘ĞĞ“ ĞšĞĞ¡ĞœĞĞ¡Ğ','Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ•Ğ›Ğ¬'];

/* â•â• STATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let G={
  energy:0,totalEver:0,clicks:0,
  prestige:0,prestigeMult:1,level:1,
  gens:{},upgs:{},stars:{},
  friends:[],friendBonus:0,
  combo:1,comboTimer:0,
  lastClick:0,
};

/* â•â• COMPUTED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let clickPow=1,autoCps=0,globalMult=1,genMults={};

function recalc(){
  clickPow=1;autoCps=0;globalMult=1;genMults={};
  UPGRADES.forEach(u=>{
    if(!G.upgs[u.id])return;
    if(u.type==='click')  clickPow*=u.val;
    if(u.type==='auto')   autoCps+=u.val;
    if(u.type==='global') globalMult*=u.val;
    if(u.type==='gen')    genMults[u.id2]=(genMults[u.id2]||1)*u.val;
  });
  if(G.stars['autoclick']) autoCps+=100;
  if(G.stars['x5'])        globalMult*=5;
  if(G.stars['frenzy_active']) globalMult*=3;
  if(G.friendBonus>0) globalMult*=(1+G.friendBonus/100);
}

function calcCps(){
  let t=0;
  GENS.forEach(g=>{
    const own=G.gens[g.id]||0;
    const gm=genMults[g.id]||1;
    t+=own*g.baseCps*gm;
  });
  t+=autoCps*clickPow;
  return t*globalMult*G.prestigeMult;
}

function effectiveClick(){
  const base=clickPow*globalMult*G.prestigeMult;
  return base*G.combo;
}

/* â•â• FORMAT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function fmt(n){
  if(n<1000)return Math.floor(n).toString();
  const s=['','K','M','B','T','Qa','Qi','Sx'];
  let i=0;
  while(n>=1000&&i<s.length-1){n/=1000;i++;}
  return n.toFixed(2)+s[i];
}

/* â•â• COMBO SYSTEM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const COMBO_TIMEOUT=3000; // ms
const COMBO_MAX=5;

function addCombo(){
  G.combo=Math.min(COMBO_MAX,G.combo+.1);
  G.comboTimer=COMBO_TIMEOUT;
}
function decayCombo(dt){
  if(G.comboTimer>0){
    G.comboTimer-=dt*1000;
    if(G.comboTimer<=0){G.combo=1;G.comboTimer=0;}
  }
}

/* â•â• CLICK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.getElementById('mainBtn').addEventListener('click',function(e){
  const isCrit=Math.random()<.1; // 10% crit
  const gain=effectiveClick()*(isCrit?5:1);
  G.energy+=gain;G.totalEver+=gain;G.clicks++;
  addCombo();
  checkLevel();

  // Particle
  const p=document.createElement('div');
  p.className='ptc'+(isCrit?' ptc-crit':'');
  p.textContent=(isCrit?'ğŸ’¥ ĞšĞ Ğ˜Ğ¢! ':'+')+fmt(gain);
  const r=this.getBoundingClientRect();
  const jx=(Math.random()-.5)*70, jy=(Math.random()-.5)*30;
  p.style.left=(r.left+r.width/2+jx)+'px';
  p.style.top=(r.top+r.height/3+jy)+'px';
  const hue=isCrit?30:[168,280,330][Math.floor(Math.random()*3)];
  p.style.color=`hsl(${hue},100%,70%)`;
  p.style.textShadow=`0 0 10px hsl(${hue},100%,70%)`;
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),900);

  if(isCrit)showToast('ğŸ’¥ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™ Ğ£Ğ”ĞĞ ! Ã—5');
});

document.getElementById('mainBtn').addEventListener('touchend',function(e){
  e.preventDefault();this.click();
},{passive:false});

/* â•â• LEVELS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LEVEL_THRESHOLDS=[0,100,500,2000,10000,50000,200000,1000000,5000000,20000000];
function checkLevel(){
  const lvl=LEVEL_THRESHOLDS.filter(t=>G.totalEver>=t).length;
  if(lvl>G.level){
    G.level=lvl;
    showLevelUp();
    showToast(`ğŸ–ï¸ Ğ£Ğ ĞĞ’Ğ•ĞĞ¬ ${G.level} â€” ${TITLES[Math.min(G.level-1,TITLES.length-1)]}!`);
  }
}
function showLevelUp(){
  const el=document.createElement('div');
  el.className='levelup';
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),700);
}

/* â•â• BUY GEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buyGen(id){
  const g=GENS.find(x=>x.id===id);
  const cost=Math.floor(g.baseCost*Math.pow(1.15,G.gens[id]||0));
  if(G.energy<cost)return;
  G.energy-=cost;
  G.gens[id]=(G.gens[id]||0)+1;
}

/* â•â• BUY UPGRADE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buyUpg(id){
  const u=UPGRADES.find(x=>x.id===id);
  if(!u||G.upgs[id])return;
  if(G.energy<u.cost||G.totalEver<u.req)return;
  G.energy-=u.cost;
  G.upgs[id]=true;
  recalc();
  showToast(`âœ… ${u.name} Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!`);
}

/* â•â• BUY STARS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buyStars(id){
  const item=STARS_ITEMS.find(x=>x.id===id);
  if(!item)return;
  showToast(`â­ ${item.name} â€” ${item.stars} Stars`);
  // Simulate for demo
  if(id==='frenzy'){
    G.stars['frenzy_active']=true;
    recalc();
    showToast('ğŸ”¥ FRENZY Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ½Ğ° 30 Ğ¼Ğ¸Ğ½ÑƒÑ‚!');
    setTimeout(()=>{delete G.stars['frenzy_active'];recalc();showToast('ğŸ”¥ Frenzy Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ğ»ÑÑ');},1800000);
  }else if(id==='prestige'){
    G.prestige++;
    G.prestigeMult=1+G.prestige*.5;
    recalc();
    showToast(`âœ¨ ĞŸÑ€ĞµÑÑ‚Ğ¸Ğ¶ Ã—${G.prestige} â€” Ğ±ĞµĞ· ÑĞ±Ñ€Ğ¾ÑĞ°!`);
  }else{
    G.stars[id]=true;
    recalc();
    showToast(`âœ… ${item.name} ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ¾!`);
  }
  save();
}

/* â•â• PRESTIGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.getElementById('prestigeBtn').addEventListener('click',function(){
  if(G.totalEver<PRESTIGE_GOAL)return;
  if(!confirm('Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ +50%?'))return;
  G.prestige++;G.prestigeMult=1+G.prestige*.5;
  G.energy=0;G.totalEver=0;G.clicks=0;G.level=1;
  G.gens={};G.upgs={};G.combo=1;G.comboTimer=0;
  recalc();save();
  showToast(`âœ¨ ĞŸĞ Ğ•Ğ¡Ğ¢Ğ˜Ğ– Ã—${G.prestige}! Ğ‘Ğ¾Ğ½ÑƒÑ +${G.prestige*50}%`);
});

/* â•â• MILESTONES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const MS=[
  {v:100,       m:'ğŸŒ± 100 â€” Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ Ğ¿ÑƒÑ‚Ğ¸!'},
  {v:1000,      m:'âš¡ 1,000 â€” Ñ‚Ñ‹ Ğ»ĞµÑ‚Ğ¸ÑˆÑŒ!'},
  {v:10000,     m:'ğŸ”¥ 10,000 â€” Ğ³Ğ¾Ñ€ÑÑ‡Ğ¾!'},
  {v:100000,    m:'ğŸš€ 100K â€” Ğº Ğ·Ğ²Ñ‘Ğ·Ğ´Ğ°Ğ¼!'},
  {v:1000000,   m:'ğŸŒŒ ĞœĞ˜Ğ›Ğ›Ğ˜ĞĞ â€” Ğ¿Ğ¾Ñ€Ğ° Ğ² Ğ¿Ñ€ĞµÑÑ‚Ğ¸Ğ¶!'},
  {v:1000000000,m:'ğŸ’« ĞœĞ˜Ğ›Ğ›Ğ˜ĞĞ Ğ” â€” Ñ‚Ñ‹ Ğ»ĞµĞ³ĞµĞ½Ğ´Ğ°!'},
];
const _ms=new Set();
function checkMS(){MS.forEach(m=>{if(G.totalEver>=m.v&&!_ms.has(m.v)){_ms.add(m.v);showToast(m.m);}});}

/* â•â• TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showToast(msg){
  const t=document.createElement('div');
  t.className='toast';t.textContent=msg;
  document.body.appendChild(t);
  setTimeout(()=>t.remove(),3100);
}

/* â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click',function(){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    this.classList.add('active');
    document.getElementById('page-'+this.dataset.tab).classList.add('active');
  });
});

/* â•â• RENDER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let _lastRender=0;
function render(now){
  if(now-_lastRender<50)return; // 20fps cap for render
  _lastRender=now;

  const cps=calcCps();
  const ec=effectiveClick();

  document.getElementById('scoreNum').textContent=fmt(G.energy);
  document.getElementById('scoreCps').textContent='+'+fmt(cps)+'/Ñ';
  document.getElementById('hTotal').textContent=fmt(G.totalEver);
  document.getElementById('hLevel').textContent=G.level;
  document.getElementById('utitle').textContent=TITLES[Math.min(G.level-1,TITLES.length-1)];

  // Combo
  const cv=document.getElementById('comboVal');
  const cw=document.getElementById('comboWrap');
  const cb=document.getElementById('comboBar');
  cv.textContent='Ã—'+G.combo.toFixed(1);
  cw.classList.toggle('active',G.combo>1.05);
  cb.style.width=(G.comboTimer/COMBO_TIMEOUT*100)+'%';

  // Stats
  const totalGens=Object.values(G.gens).reduce((a,b)=>a+b,0);
  document.getElementById('scClick').textContent=fmt(ec);
  document.getElementById('scGens').textContent=totalGens;
  document.getElementById('scPrestige').textContent='Ã—'+G.prestigeMult.toFixed(1);

  // Prestige bar
  const pct=Math.min(100,(G.totalEver/PRESTIGE_GOAL)*100);
  document.getElementById('pbarFill').style.width=pct+'%';
  document.getElementById('pbarPct').textContent=Math.floor(pct)+'%';
  document.getElementById('prestigeBtn').style.display=G.totalEver>=PRESTIGE_GOAL?'block':'none';

  // Boost chips
  document.getElementById('bFrenzy').classList.toggle('active-boost',!!G.stars['frenzy_active']);
  document.getElementById('bLucky').classList.toggle('active-boost',Math.random()<.05);

  checkMS();
  renderShop();
  renderFriends();
}

function renderShop(){
  // Stars
  const sg=document.getElementById('starsGrid');
  if(!sg.children.length){
    STARS_ITEMS.forEach(item=>{
      const el=document.createElement('div');
      el.className='star-card';
      el.innerHTML=`
        ${item.badge?`<div class="sc-badge">${item.badge}</div>`:''}
        <div class="sc-icon">${item.icon}</div>
        <div class="sc-name">${item.name}</div>
        <div class="sc-desc">${item.desc}</div>
        <div class="sc-price">â­ ${item.stars} Stars</div>`;
      el.addEventListener('click',()=>buyStars(item.id));
      sg.appendChild(el);
    });
  }

  // Gens
  const gl=document.getElementById('genList');
  gl.innerHTML='';
  GENS.forEach(gen=>{
    const cost=Math.floor(gen.baseCost*Math.pow(1.15,G.gens[gen.id]||0));
    const owned=G.gens[gen.id]||0;
    const can=G.energy>=cost;
    const gm=genMults[gen.id]||1;
    const realCps=(gen.baseCps*gm*globalMult*G.prestigeMult);
    const el=document.createElement('div');
    el.className='gen-card'+(can?'':' gc-locked');
    el.innerHTML=`
      <div class="gc-icon">${gen.icon}</div>
      <div class="gc-body">
        <div class="gc-name">${gen.name}</div>
        <div class="gc-sub">${gen.desc}</div>
        <div class="gc-cost">${fmt(cost)} âš¡</div>
      </div>
      <div>
        <div class="gc-owned">${owned}</div>
        <div class="gc-cps">${fmt(realCps)}/Ñ</div>
      </div>`;
    if(can)el.addEventListener('click',()=>{buyGen(gen.id);renderShop();});
    gl.appendChild(el);
  });

  // Upgrades
  const ul=document.getElementById('upgList');
  ul.innerHTML='';
  UPGRADES.forEach(u=>{
    const bought=!!G.upgs[u.id];
    const can=G.energy>=u.cost;
    const unlocked=G.totalEver>=u.req;
    const el=document.createElement('div');
    el.className='upg-card'+(bought?' uc-maxed':(!can||!unlocked?' uc-locked':''));
    el.innerHTML=`
      <div class="uc-icon">${u.icon}</div>
      <div class="uc-body">
        <div class="uc-name">${u.name}</div>
        <div class="uc-desc">${u.desc}</div>
      </div>
      <div class="uc-right">
        <div class="uc-cost">${bought?'â€”':fmt(u.cost)+' âš¡'}</div>
        <div class="uc-status">${bought?'âœ“ ĞšĞ£ĞŸĞ›Ğ•ĞĞ':(unlocked?'Ğ”ĞĞ¡Ğ¢Ğ£ĞŸĞĞ':'Ğ¾Ñ‚ '+fmt(u.req))}</div>
      </div>`;
    if(!bought&&can&&unlocked)el.addEventListener('click',()=>{buyUpg(u.id);});
    ul.appendChild(el);
  });
}

function renderFriends(){
  document.getElementById('friendCount').textContent=G.friends.length;
  const fl=document.getElementById('friendList');
  fl.innerHTML='';
  if(!G.friends.length){
    fl.innerHTML='<div style="text-align:center;color:var(--dim);font-size:12px;padding:24px">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ°!</div>';
    return;
  }
  G.friends.forEach(f=>{
    const el=document.createElement('div');el.className='friend-row';
    el.innerHTML=`
      <div class="fr-av">${(f.name[0]||'?').toUpperCase()}</div>
      <div class="fr-info"><div class="fr-name">${f.name}</div><div class="fr-score">${fmt(f.score)} âš¡</div></div>
      <div class="fr-earn">+${fmt(f.earned)} Ğ±Ğ¾Ğ½ÑƒÑ</div>`;
    fl.appendChild(el);
  });
}

/* â•â• SHARE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.getElementById('shareBtn').addEventListener('click',()=>{
  const bot='CosmicClickerBot';
  const ref=TGU?.id||'demo';
  const url=`https://t.me/${bot}?start=ref_${ref}`;
  const txt='ğŸš€ Ğ˜Ğ³Ñ€Ğ°Ğ¹ Ğ² COSMIC CLICKER â€” Ğ¿Ğ¾ĞºĞ¾Ñ€ÑĞ¹ Ğ²ÑĞµĞ»ĞµĞ½Ğ½ÑƒÑ Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ! ĞĞ±Ğ° Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ¼ Ğ±Ğ¾Ğ½ÑƒÑ!';
  if(tg?.openTelegramLink){
    tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(txt)}`);
  }else{
    navigator.clipboard?.writeText(url);
    showToast('ğŸ“‹ Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!');
  }
});

/* â•â• INIT USER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initUser(){
  if(!TGU)return;
  const name=TGU.first_name+(TGU.last_name?' '+TGU.last_name:'');
  document.getElementById('uname').textContent=name;
  const av=document.getElementById('avatar');
  if(TGU.photo_url){av.innerHTML=`<img src="${TGU.photo_url}" alt="">`;}
  else{av.textContent=(name[0]||'?').toUpperCase();}
}

/* â•â• SAVE / LOAD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const KEY='cosmicV3';
function save(){
  try{localStorage.setItem(KEY,JSON.stringify({
    energy:G.energy,totalEver:G.totalEver,clicks:G.clicks,
    prestige:G.prestige,prestigeMult:G.prestigeMult,level:G.level,
    gens:G.gens,upgs:G.upgs,stars:G.stars,
    friends:G.friends,friendBonus:G.friendBonus,
  }));}catch(e){}
}
function load(){
  try{
    const raw=localStorage.getItem(KEY);
    if(!raw)return;
    const d=JSON.parse(raw);
    Object.assign(G,d);
    recalc();
    MS.forEach(m=>{if(G.totalEver>=m.v)_ms.add(m.v);});
  }catch(e){}
}

/* â•â• GAME LOOP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let last=performance.now();

function loop(now){
  const dt=Math.min((now-last)/1000,.5);
  last=now;

  // Passive income
  const gain=calcCps()*dt;
  G.energy+=gain;G.totalEver+=gain;

  // Combo decay
  decayCombo(dt);

  // Check level
  checkLevel();

  render(now);
  requestAnimationFrame(loop);
}

/* â•â• BOOT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
load();
recalc();
initUser();
renderShop();
renderFriends();
requestAnimationFrame(loop);
setInterval(save,5000);

// Touch fix
document.getElementById('mainBtn').addEventListener('touchend',e=>{
  e.preventDefault();
},{passive:false});
</script>
</body>
</html>
